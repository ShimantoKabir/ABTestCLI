(()=>{"use strict";var e={65:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.planInfo=t.modalStatusKey=t.selectors=void 0,t.selectors={existPlanSection:"h3.css-1kq534c",bullet:"div.bullet",phoneSelectorArea:"div.phone-selector-area",planContainer:"div.css-w9ctd9",plan:"div.css-mybjz6",price:"p.css-13qu9nj",viewPlanLink:"a.css-93vlq5",phoneSelector:"div.phone-selector",circle:"div.circle",comboPlan:"section.most-plans>div:nth-child(3)>div.plan-selection-wrapper>button",buttonShop:"button.btn-shop",modalCloseButton:"div.added-to-cart-modal button.cci-shopping-modal-close",modal:"div.added-to-cart-modal",shoppingPageContainer:"div#shopping-page-container",placeHolderImg:"img.placeholder-image"},t.modalStatusKey="add-device-model-open",t.planInfo={0:[{price:"20",internet:"1GB"},{price:"25",internet:"5GB"},{price:"35",internet:"10GB"},{price:"50",internet:"UNLIMITED*"}],1:[{price:"35",internet:"1GB"},{price:"40",internet:"5GB"},{price:"50",internet:"10GB"},{price:"65",internet:"UNLIMITED*"}],2:[{price:"50",internet:"1GB"},{price:"55",internet:"5GB"},{price:"65",internet:"10GB"},{price:"80",internet:"UNLIMITED*"}]}},509:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TestInfo=void 0,(n=t.TestInfo||(t.TestInfo={})).ID="CC001",n.SITE="consumercellular",n.CLIENT="brainlab",n.VARIATION="1"},912:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LineSelectionManager=void 0;var i=n(951),o=n(65),l=n(509);t.LineSelectionManager=function(e,t){var n=this;this.plan=0,this.line=0,this.select=function(){n.selectLine(),n.selectPlan(),n.clickAddToCartButton()},this.selectLine=function(){var e=document.querySelectorAll(o.selectors.phoneSelector);e&&e.length>3?e.forEach((function(e,t){if(t===n.line){var i=document.querySelector("div.phone-selections>div:nth-child(".concat(t+1,")>div.fa-circle"));i&&i.click()}})):setTimeout(n.selectLine,25)},this.selectPlan=function(){var e=document.querySelectorAll(o.selectors.comboPlan);e&&e.length>3?e.forEach((function(e,t){t===n.plan&&e.click()})):setTimeout(n.selectPlan,25)},this.clickAddToCartButton=function(){var e=document.querySelector(o.selectors.buttonShop);e&&"disabled"!==e.getAttribute("disabled")?(e.click(),n.closeModal()):setTimeout(n.clickAddToCartButton,25)},this.closeModal=function(){var e=document.querySelector(o.selectors.modalCloseButton);e?(localStorage.setItem("add-device-model-open","true"),e.click()):setTimeout(n.closeModal,25)},this.plan=e,this.line=t,i.Initializer.init(l.TestInfo,"0.0.1")}},701:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LineComponent=void 0;var i=n(65),o=n(670);t.LineComponent=function(){this.render=function(){return'\n    <div class="line-selection-component flex-content">\n      <div class="phone-selection-wrapper">\n        <div class="phone-selections">\n          <div class="phone-selector phone-selector-area" >\n            <input type="radio" name="line-selection" value="1">\n            <div class="circle-selected fa fa-circle bullet" bullet-number="0" ></div>\n            <div class="line"></div>\n            <p class="line-text line-text-selected">1</p>\n          </div>\n          <div class="phone-selector phone-selector-area">\n            <input type="radio" name="line-selection" value="2">\n            <div class="circle fa fa-circle bullet" bullet-number="1"></div>\n            <div class="line"></div>\n            <p class="line-text">2</p>  \n          </div>\n          <div class="phone-selector phone-selector-area">\n            <input type="radio" name="line-selection" value="3">\n            <div class="circle fa fa-circle bullet" bullet-number="2"></div>\n            <div class="line"></div>  \n            <p class="line-text">3</p>\n          </div>\n          <div class="phone-selector last-phone-selector">\n            <div class="four-lines">\n              <p class="four-lines-text">Need 4 or more lines?</p>\n              <p class="four-lines-number">Give us a call (888) 345-5509</p>\n            </div>\n            <div class="circle-four fa fa-circle"></div>\n            <p class="line-text">4</p>\n          </div>\n        </div>\n      </div>\n    </div>\n    '.trim()},this.addBulletClickEvent=function(){document.querySelectorAll(i.selectors.bullet).forEach((function(e){e.addEventListener("click",(function(e){if(e.target){for(var t=e.target,n=Number(t.getAttribute("bullet-number")),l=document.querySelectorAll(i.selectors.phoneSelectorArea),c=0;c<n;c++){var s=l[c].childNodes[5],r=l[c+1].childNodes[3];s.classList.add("line-selected"),s.classList.remove("line"),r.classList.add("circle-selected"),r.classList.remove("circle")}for(c=n;c<l.length;c++){s=l[c].childNodes[5];var a=l[c+1];if(a){var d=a.childNodes[3];s.classList.remove("line-selected"),s.classList.add("line"),d.classList.remove("circle-selected"),d.classList.add("circle")}}for(c=0;c<l.length;c++){var u=l[c].childNodes[7];c===n?u.classList.add("line-text-selected"):u.classList.remove("line-text-selected")}o.PlanComponent.changePlanData(n)}}))}))}}},872:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MainComponent=void 0;var i=n(951),o=n(65),l=n(509),c=n(701),s=n(670),r=n(345);t.MainComponent=function(){this.init=function(){i.Initializer.init(l.TestInfo,"0.0.1");var e=document.querySelector(o.selectors.existPlanSection);if(e){var t=new c.LineComponent;e.insertAdjacentHTML("afterend",t.render()),t.addBulletClickEvent()}var n=document.querySelector(o.selectors.planContainer);if(n){n.insertAdjacentHTML("afterbegin",n.firstChild.outerHTML);var a=document.querySelectorAll("p.css-13qu9nj");a&&a.length>3&&(a[1].textContent="25")}s.PlanComponent.addPLanClickEvent();var d=new r.RedirectButtonComponent;d.render(),d.addRedirectEvent()}}},401:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ModalComponent=void 0;var i=n(65);t.ModalComponent=function(){var e=this;this.getHtml=function(){return'\n            <div class="added-to-cart-modal" style="z-index: 19002">\n                <div class="cci-modal-mask" style="">\n                    <div class="cci-modal-scroll-wrapper">\n                        <div class="cci-modal-wrapper">\n                            <div class="cci-modal-container">\n                                <button type="button" aria-label="Close" class="cci-shopping-modal-close btn btn-link"></button>\n                                <div class="cci-modal-header">\n                                    <h3></h3>\n                                </div>\n                                <div class="cci-modal-body">\n                                    <span aria-label="Check mark indicates selection has been made."\n                                        class="fa fa-check-circle white-bg circle-icon green"></span>\n                                    <span class="modal-title">Successfully Added To Cart</span>\n                                    <div class="row">\n                                        <a href="/shopping/choose/device" class="btn btn-default next-step-button btn-shop"> Add\n                                            A Device </a>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        '.trim()},this.render=function(){var t,n=document.querySelectorAll(i.selectors.placeHolderImg);if(n&&n.length>0){null===(t=document.querySelector("body"))||void 0===t||t.insertAdjacentHTML("beforeend",e.getHtml()),localStorage.removeItem(i.modalStatusKey);var o=document.querySelector(i.selectors.modalCloseButton);null==o||o.addEventListener("click",(function(){var e;null===(e=document.querySelector(i.selectors.modal))||void 0===e||e.remove()}))}}}},670:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlanComponent=void 0;var i=n(65),o=function(){function e(){}return e.changePlanData=function(e){var t=i.planInfo[e];document.querySelectorAll(i.selectors.price).forEach((function(e,n){e.textContent=t[n].price}))},e.addPLanClickEvent=function(){var e=document.querySelectorAll(i.selectors.plan);e&&e.length>0&&(e[0].classList.add("plan-selected"),e.forEach((function(t){t.addEventListener("click",(function(){for(var n=0;n<e.length;n++)t===e[n]?e[n].classList.add("plan-selected"):e[n].classList.remove("plan-selected")}))})))},e}();t.PlanComponent=o},345:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectButtonComponent=void 0;var i=n(65);t.RedirectButtonComponent=function(){var e=this;this.getHtml=function(){return'\n      <button href="https://www.consumercellular.com/shopping/details/sim" class="redirect-button">\n        Add To Cart\n      </button>\n    '},this.render=function(){var t=document.querySelector(i.selectors.viewPlanLink);t&&t.insertAdjacentHTML("afterend",e.getHtml())},this.addRedirectEvent=function(){var t=document.querySelector("button.redirect-button");t&&t.addEventListener("click",(function(){var t=e.getSelectedPlanNumber(),n=e.getSelectedBulletNumber();e.redirectToPlanPage(t,n)}))},this.redirectToPlanPage=function(e,t){window.location.href="https://www.consumercellular.com/shopping/choose/plan?line=".concat(t,"&plan=").concat(e)},this.getSelectedPlanNumber=function(){var e=0,t=document.querySelectorAll(i.selectors.plan);return t&&t.length>0&&t.forEach((function(n,i){t[i].classList.contains("plan-selected")&&(e=i)})),e},this.getSelectedBulletNumber=function(){var e=0,t=document.querySelectorAll(i.selectors.bullet);return t&&t.length>0&&t.forEach((function(n,i){t[i].classList.contains("circle-selected")&&(e+=i)})),e}}},457:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TestObserver=void 0;t.TestObserver=function(e){var t=this;this.targetNode=null,this.config={},this.observe=function(e){new MutationObserver(e).observe(t.targetNode,t.config)},this.targetNode=document.querySelector(e),this.config={attributes:!0,childList:!0,subtree:!0}}},951:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Initializer=void 0;var n=function(){function e(){}return e.init=function(e,t){document.documentElement.classList.add(e.ID),document.documentElement.classList.add("".concat(e.ID,"-").concat(e.VARIATION)),console.info("ID: ".concat(e.ID,", VARIATION: ").concat(e.VARIATION,", VERSION: ").concat(t," is running.....!"))},e}();t.Initializer=n},454:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Poller=void 0;var i=n(704);t.Poller=function(){var e=this;this.options=null,this.timeout=null,this.successfulConditions=[],this.callback=function(){},this.conditionsLength=0,this.poll=function(t,n,o){e.callback=n,e.options=new i.UserOptions,e.conditionsLength=t.length,o&&(e.options=o),e.timeout=e.options.timeout?new Date(e.getNow()+e.options.timeout).getTime():null;for(var l=0;l<t.length;l++)e.pollForCondition(t[l],e.options.wait,!0,e.options.multiplier)},this.getNow=function(){return(new Date).getTime()},this.isTimeOut=function(){return!!(e.timeout&&e.getNow()>e.timeout)},this.evaluateCondition=function(e){return!!e&&("function"==typeof e?e():!("string"!=typeof e||!document.querySelector(e)))},this.isAllConditionPassed=function(){return e.conditionsLength===e.successfulConditions.length},this.pollForCondition=function(t,n,i,o){if(e.timeout&&e.isTimeOut())return!1;var l=e.evaluateCondition(t);return l?(e.successfulConditions.push(l),e.isAllConditionPassed()&&e.callback(e.successfulConditions)):setTimeout((function(){e.pollForCondition(t,n*o,i,o)}),i?0:n),!0}}},704:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserOptions=void 0;t.UserOptions=function(){this.wait=50,this.multiplier=1.1,this.timeout=0}}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var l=t[i]={exports:{}};return e[i](l,l.exports,n),l.exports}(()=>{var e=n(454),t=n(65),i=n(912),o=n(872),l=n(401),c=n(457);if(!/MSIE|Trident|Edge\/(12|13|14|15|16|17|18)/.test(window.navigator.userAgent)){var s=new o.MainComponent;(new e.Poller).poll(["body",t.selectors.existPlanSection,t.selectors.planContainer],s.init);var r=new URLSearchParams(window.location.search);if(r.has("plan")&&r.has("line")){var a=Number(r.get("plan")),d=Number(r.get("line"));new i.LineSelectionManager(a,d).select()}new c.TestObserver(t.selectors.shoppingPageContainer).observe((function(e,n){"true"===localStorage.getItem(t.modalStatusKey)&&"/shopping"===window.location.pathname&&(new l.ModalComponent).render()}))}})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YUFBYWdILFFBQVEsRUFBQXhJLGlCQUNrQixjQUE3QnVFLE9BQU9DLFNBQVNpRSxXQUNyQixJQUFJLEVBQUE5RSxnQkFDWjdCLFFBRW5CLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hYi10ZXN0LXRzLWNsaS8uL3NyYy9jbGllbnRzL2JyYWlubGFiL2NvbnN1bWVyY2VsbHVsYXIvQ0MwMDEvY29tbW9uL2Fzc2V0LnRzIiwid2VicGFjazovL2FiLXRlc3QtdHMtY2xpLy4vc3JjL2NsaWVudHMvYnJhaW5sYWIvY29uc3VtZXJjZWxsdWxhci9DQzAwMS9jb21tb24vdGVzdC5pbmZvLnRzIiwid2VicGFjazovL2FiLXRlc3QtdHMtY2xpLy4vc3JjL2NsaWVudHMvYnJhaW5sYWIvY29uc3VtZXJjZWxsdWxhci9DQzAwMS9jb21wb25lbnRzL2xpbmUtc2VsZWN0aW9uLW1hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vYWItdGVzdC10cy1jbGkvLi9zcmMvY2xpZW50cy9icmFpbmxhYi9jb25zdW1lcmNlbGx1bGFyL0NDMDAxL2NvbXBvbmVudHMvbGluZS5jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vYWItdGVzdC10cy1jbGkvLi9zcmMvY2xpZW50cy9icmFpbmxhYi9jb25zdW1lcmNlbGx1bGFyL0NDMDAxL2NvbXBvbmVudHMvbWFpbi5jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vYWItdGVzdC10cy1jbGkvLi9zcmMvY2xpZW50cy9icmFpbmxhYi9jb25zdW1lcmNlbGx1bGFyL0NDMDAxL2NvbXBvbmVudHMvbW9kYWwuY29tcG9uZW50LnRzIiwid2VicGFjazovL2FiLXRlc3QtdHMtY2xpLy4vc3JjL2NsaWVudHMvYnJhaW5sYWIvY29uc3VtZXJjZWxsdWxhci9DQzAwMS9jb21wb25lbnRzL3BsYW4uY29tcG9uZW50LnRzIiwid2VicGFjazovL2FiLXRlc3QtdHMtY2xpLy4vc3JjL2NsaWVudHMvYnJhaW5sYWIvY29uc3VtZXJjZWxsdWxhci9DQzAwMS9jb21wb25lbnRzL3JlZGlyZWN0LWJ1dHRvbi5jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vYWItdGVzdC10cy1jbGkvLi9zcmMvY2xpZW50cy9icmFpbmxhYi9jb25zdW1lcmNlbGx1bGFyL0NDMDAxL29ic2VydmVyL3Rlc3Qub2JzZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vYWItdGVzdC10cy1jbGkvLi9zcmMvdXRpbGl0aWVzL2luaXRpYWxpemVyLnRzIiwid2VicGFjazovL2FiLXRlc3QtdHMtY2xpLy4vc3JjL3V0aWxpdGllcy9wb2xsZXIudHMiLCJ3ZWJwYWNrOi8vYWItdGVzdC10cy1jbGkvLi9zcmMvdXRpbGl0aWVzL3VzZXIub3B0aW9ucy50cyIsIndlYnBhY2s6Ly9hYi10ZXN0LXRzLWNsaS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9hYi10ZXN0LXRzLWNsaS8uL3NyYy9jbGllbnRzL2JyYWlubGFiL2NvbnN1bWVyY2VsbHVsYXIvQ0MwMDEvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICBleGlzdFBsYW5TZWN0aW9uOiBcImgzLmNzcy0xa3E1MzRjXCIsXHJcbiAgYnVsbGV0OiBcImRpdi5idWxsZXRcIixcclxuICBwaG9uZVNlbGVjdG9yQXJlYTogXCJkaXYucGhvbmUtc2VsZWN0b3ItYXJlYVwiLFxyXG4gIHBsYW5Db250YWluZXI6IFwiZGl2LmNzcy13OWN0ZDlcIixcclxuICBwbGFuOiBcImRpdi5jc3MtbXliano2XCIsXHJcbiAgcHJpY2U6IFwicC5jc3MtMTNxdTlualwiLFxyXG4gIHZpZXdQbGFuTGluazogXCJhLmNzcy05M3ZscTVcIixcclxuICBwaG9uZVNlbGVjdG9yOiBcImRpdi5waG9uZS1zZWxlY3RvclwiLFxyXG4gIGNpcmNsZTogXCJkaXYuY2lyY2xlXCIsXHJcbiAgY29tYm9QbGFuOlxyXG4gICAgXCJzZWN0aW9uLm1vc3QtcGxhbnM+ZGl2Om50aC1jaGlsZCgzKT5kaXYucGxhbi1zZWxlY3Rpb24td3JhcHBlcj5idXR0b25cIixcclxuICBidXR0b25TaG9wOiBcImJ1dHRvbi5idG4tc2hvcFwiLFxyXG4gIG1vZGFsQ2xvc2VCdXR0b246IFwiZGl2LmFkZGVkLXRvLWNhcnQtbW9kYWwgYnV0dG9uLmNjaS1zaG9wcGluZy1tb2RhbC1jbG9zZVwiLFxyXG4gIG1vZGFsOiBcImRpdi5hZGRlZC10by1jYXJ0LW1vZGFsXCIsXHJcbiAgc2hvcHBpbmdQYWdlQ29udGFpbmVyOiBcImRpdiNzaG9wcGluZy1wYWdlLWNvbnRhaW5lclwiLFxyXG4gIHBsYWNlSG9sZGVySW1nOiBcImltZy5wbGFjZWhvbGRlci1pbWFnZVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IG1vZGFsU3RhdHVzS2V5OiBzdHJpbmcgPSBcImFkZC1kZXZpY2UtbW9kZWwtb3BlblwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IHBsYW5JbmZvOiBhbnkgPSB7XHJcbiAgXCIwXCI6IFtcclxuICAgIHtcclxuICAgICAgcHJpY2U6IFwiMjBcIixcclxuICAgICAgaW50ZXJuZXQ6IFwiMUdCXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBwcmljZTogXCIyNVwiLFxyXG4gICAgICBpbnRlcm5ldDogXCI1R0JcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHByaWNlOiBcIjM1XCIsXHJcbiAgICAgIGludGVybmV0OiBcIjEwR0JcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHByaWNlOiBcIjUwXCIsXHJcbiAgICAgIGludGVybmV0OiBcIlVOTElNSVRFRCpcIixcclxuICAgIH0sXHJcbiAgXSxcclxuICBcIjFcIjogW1xyXG4gICAge1xyXG4gICAgICBwcmljZTogXCIzNVwiLFxyXG4gICAgICBpbnRlcm5ldDogXCIxR0JcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIHByaWNlOiBcIjQwXCIsXHJcbiAgICAgIGludGVybmV0OiBcIjVHQlwiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgcHJpY2U6IFwiNTBcIixcclxuICAgICAgaW50ZXJuZXQ6IFwiMTBHQlwiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgcHJpY2U6IFwiNjVcIixcclxuICAgICAgaW50ZXJuZXQ6IFwiVU5MSU1JVEVEKlwiLFxyXG4gICAgfSxcclxuICBdLFxyXG4gIFwiMlwiOiBbXHJcbiAgICB7XHJcbiAgICAgIHByaWNlOiBcIjUwXCIsXHJcbiAgICAgIGludGVybmV0OiBcIjFHQlwiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgcHJpY2U6IFwiNTVcIixcclxuICAgICAgaW50ZXJuZXQ6IFwiNUdCXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBwcmljZTogXCI2NVwiLFxyXG4gICAgICBpbnRlcm5ldDogXCIxMEdCXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBwcmljZTogXCI4MFwiLFxyXG4gICAgICBpbnRlcm5ldDogXCJVTkxJTUlURUQqXCIsXHJcbiAgICB9LFxyXG4gIF0sXHJcbn07XHJcbiIsImV4cG9ydCBlbnVtIFRlc3RJbmZvIHtJRCA9ICdDQzAwMScsIFNJVEUgPSAnY29uc3VtZXJjZWxsdWxhcicsIENMSUVOVCA9ICdicmFpbmxhYicsIFZBUklBVElPTiA9ICcxJ30iLCJpbXBvcnQgeyBJbml0aWFsaXplciB9IGZyb20gXCIuLi8uLi8uLi8uLi8uLi91dGlsaXRpZXMvaW5pdGlhbGl6ZXJcIjtcclxuaW1wb3J0IHsgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL2NvbW1vbi9hc3NldFwiO1xyXG5pbXBvcnQgeyBUZXN0SW5mbyB9IGZyb20gXCIuLi9jb21tb24vdGVzdC5pbmZvXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTGluZVNlbGVjdGlvbk1hbmFnZXIge1xyXG4gIHByaXZhdGUgcGxhbjogbnVtYmVyID0gMDtcclxuICBwcml2YXRlIGxpbmU6IG51bWJlciA9IDA7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsYW46IG51bWJlciwgbGluZTogbnVtYmVyKSB7XHJcbiAgICB0aGlzLnBsYW4gPSBwbGFuO1xyXG4gICAgdGhpcy5saW5lID0gbGluZTtcclxuICAgIEluaXRpYWxpemVyLmluaXQoVGVzdEluZm8sIFwiMC4wLjFcIik7XHJcbiAgfVxyXG5cclxuICBzZWxlY3QgPSAoKSA9PiB7XHJcbiAgICB0aGlzLnNlbGVjdExpbmUoKTtcclxuICAgIHRoaXMuc2VsZWN0UGxhbigpO1xyXG4gICAgdGhpcy5jbGlja0FkZFRvQ2FydEJ1dHRvbigpO1xyXG4gIH07XHJcblxyXG4gIHNlbGVjdExpbmUgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBwaG9uZVNlbGVjdG9yczogbnVsbCB8IE5vZGVMaXN0T2Y8SFRNTERpdkVsZW1lbnQ+ID1cclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMucGhvbmVTZWxlY3Rvcik7XHJcblxyXG4gICAgaWYgKHBob25lU2VsZWN0b3JzICYmIHBob25lU2VsZWN0b3JzLmxlbmd0aCA+IDMpIHtcclxuICAgICAgcGhvbmVTZWxlY3RvcnMuZm9yRWFjaCgocGhvbmUsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgaWYgKGluZGV4ID09PSB0aGlzLmxpbmUpIHtcclxuICAgICAgICAgIGNvbnN0IGJ1bGxldDogbnVsbCB8IEhUTUxEaWFsb2dFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgICAgYGRpdi5waG9uZS1zZWxlY3Rpb25zPmRpdjpudGgtY2hpbGQoJHtpbmRleCArIDF9KT5kaXYuZmEtY2lyY2xlYFxyXG4gICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICBpZiAoYnVsbGV0KSB7XHJcbiAgICAgICAgICAgIGJ1bGxldC5jbGljaygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZXRUaW1lb3V0KHRoaXMuc2VsZWN0TGluZSwgMjUpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNlbGVjdFBsYW4gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBwbGFuczogbnVsbCB8IE5vZGVMaXN0T2Y8SFRNTEJ1dHRvbkVsZW1lbnQ+ID1cclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMuY29tYm9QbGFuKTtcclxuXHJcbiAgICBpZiAocGxhbnMgJiYgcGxhbnMubGVuZ3RoID4gMykge1xyXG4gICAgICBwbGFucy5mb3JFYWNoKChwbGFuLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5wbGFuKSB7XHJcbiAgICAgICAgICBwbGFuLmNsaWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldFRpbWVvdXQodGhpcy5zZWxlY3RQbGFuLCAyNSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY2xpY2tBZGRUb0NhcnRCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBhZGRUb0NhcnRCdXR0b246IG51bGwgfCBIVE1MQnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHNlbGVjdG9ycy5idXR0b25TaG9wXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChcclxuICAgICAgYWRkVG9DYXJ0QnV0dG9uICYmXHJcbiAgICAgIGFkZFRvQ2FydEJ1dHRvbi5nZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSAhPT0gXCJkaXNhYmxlZFwiXHJcbiAgICApIHtcclxuICAgICAgYWRkVG9DYXJ0QnV0dG9uLmNsaWNrKCk7XHJcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2V0VGltZW91dCh0aGlzLmNsaWNrQWRkVG9DYXJ0QnV0dG9uLCAyNSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY2xvc2VNb2RhbCA9ICgpID0+IHtcclxuICAgIGNvbnN0IG1vZGFsQ2xvc2VCdXR0b246IG51bGwgfCBIVE1MQnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHNlbGVjdG9ycy5tb2RhbENsb3NlQnV0dG9uXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChtb2RhbENsb3NlQnV0dG9uKSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWRkLWRldmljZS1tb2RlbC1vcGVuXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgbW9kYWxDbG9zZUJ1dHRvbi5jbGljaygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2V0VGltZW91dCh0aGlzLmNsb3NlTW9kYWwsIDI1KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbiIsImltcG9ydCB7IHNlbGVjdG9ycyB9IGZyb20gXCIuLi9jb21tb24vYXNzZXRcIjtcclxuaW1wb3J0IHsgUGxhbkNvbXBvbmVudCB9IGZyb20gXCIuL3BsYW4uY29tcG9uZW50XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTGluZUNvbXBvbmVudCB7XHJcbiAgcmVuZGVyID0gKCk6IHN0cmluZyA9PiB7XHJcbiAgICBjb25zdCBodG1sU3RyaW5nID0gYFxyXG4gICAgPGRpdiBjbGFzcz1cImxpbmUtc2VsZWN0aW9uLWNvbXBvbmVudCBmbGV4LWNvbnRlbnRcIj5cclxuICAgICAgPGRpdiBjbGFzcz1cInBob25lLXNlbGVjdGlvbi13cmFwcGVyXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cInBob25lLXNlbGVjdGlvbnNcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJwaG9uZS1zZWxlY3RvciBwaG9uZS1zZWxlY3Rvci1hcmVhXCIgPlxyXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImxpbmUtc2VsZWN0aW9uXCIgdmFsdWU9XCIxXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjaXJjbGUtc2VsZWN0ZWQgZmEgZmEtY2lyY2xlIGJ1bGxldFwiIGJ1bGxldC1udW1iZXI9XCIwXCIgPjwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGluZVwiPjwvZGl2PlxyXG4gICAgICAgICAgICA8cCBjbGFzcz1cImxpbmUtdGV4dCBsaW5lLXRleHQtc2VsZWN0ZWRcIj4xPC9wPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwicGhvbmUtc2VsZWN0b3IgcGhvbmUtc2VsZWN0b3ItYXJlYVwiPlxyXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImxpbmUtc2VsZWN0aW9uXCIgdmFsdWU9XCIyXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjaXJjbGUgZmEgZmEtY2lyY2xlIGJ1bGxldFwiIGJ1bGxldC1udW1iZXI9XCIxXCI+PC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaW5lXCI+PC9kaXY+XHJcbiAgICAgICAgICAgIDxwIGNsYXNzPVwibGluZS10ZXh0XCI+MjwvcD4gIFxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwicGhvbmUtc2VsZWN0b3IgcGhvbmUtc2VsZWN0b3ItYXJlYVwiPlxyXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImxpbmUtc2VsZWN0aW9uXCIgdmFsdWU9XCIzXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjaXJjbGUgZmEgZmEtY2lyY2xlIGJ1bGxldFwiIGJ1bGxldC1udW1iZXI9XCIyXCI+PC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaW5lXCI+PC9kaXY+ICBcclxuICAgICAgICAgICAgPHAgY2xhc3M9XCJsaW5lLXRleHRcIj4zPC9wPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwicGhvbmUtc2VsZWN0b3IgbGFzdC1waG9uZS1zZWxlY3RvclwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZm91ci1saW5lc1wiPlxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzPVwiZm91ci1saW5lcy10ZXh0XCI+TmVlZCA0IG9yIG1vcmUgbGluZXM/PC9wPlxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzPVwiZm91ci1saW5lcy1udW1iZXJcIj5HaXZlIHVzIGEgY2FsbCAoODg4KSAzNDUtNTUwOTwvcD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjaXJjbGUtZm91ciBmYSBmYS1jaXJjbGVcIj48L2Rpdj5cclxuICAgICAgICAgICAgPHAgY2xhc3M9XCJsaW5lLXRleHRcIj40PC9wPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgICBgO1xyXG5cclxuICAgIHJldHVybiBodG1sU3RyaW5nLnRyaW0oKTtcclxuICB9O1xyXG5cclxuICBhZGRCdWxsZXRDbGlja0V2ZW50ID0gKCkgPT4ge1xyXG4gICAgY29uc3QgYnVsbGV0czogbnVsbCB8IE5vZGVMaXN0T2Y8RWxlbWVudD4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICBzZWxlY3RvcnMuYnVsbGV0XHJcbiAgICApO1xyXG5cclxuICAgIGJ1bGxldHMuZm9yRWFjaCgoYnVsbGV0KSA9PiB7XHJcbiAgICAgIGJ1bGxldC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGU6IEV2ZW50KSA9PiB7XHJcbiAgICAgICAgaWYgKGUudGFyZ2V0KSB7XHJcbiAgICAgICAgICBjb25zdCBidWxsZXRFbG06IEhUTUxEaXZFbGVtZW50ID0gZS50YXJnZXQgYXMgSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4gICAgICAgICAgY29uc3QgYnVsbGV0TnVtYmVyOiBudW1iZXIgPSBOdW1iZXIoXHJcbiAgICAgICAgICAgIGJ1bGxldEVsbS5nZXRBdHRyaWJ1dGUoXCJidWxsZXQtbnVtYmVyXCIpXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIGNvbnN0IHBob25lU2VsZWN0b3JBcmVhczogbnVsbCB8IE5vZGVMaXN0T2Y8RWxlbWVudD4gPVxyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5waG9uZVNlbGVjdG9yQXJlYSk7XHJcblxyXG4gICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGJ1bGxldE51bWJlcjsgaW5kZXgrKykge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5lID0gcGhvbmVTZWxlY3RvckFyZWFzW2luZGV4XVxyXG4gICAgICAgICAgICAgIC5jaGlsZE5vZGVzWzVdIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgY29uc3QgYnVsbGV0ID0gcGhvbmVTZWxlY3RvckFyZWFzW2luZGV4ICsgMV1cclxuICAgICAgICAgICAgICAuY2hpbGROb2Rlc1szXSBhcyBIVE1MRGl2RWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgIGxpbmUuY2xhc3NMaXN0LmFkZChcImxpbmUtc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgIGxpbmUuY2xhc3NMaXN0LnJlbW92ZShcImxpbmVcIik7XHJcblxyXG4gICAgICAgICAgICBidWxsZXQuY2xhc3NMaXN0LmFkZChcImNpcmNsZS1zZWxlY3RlZFwiKTtcclxuICAgICAgICAgICAgYnVsbGV0LmNsYXNzTGlzdC5yZW1vdmUoXCJjaXJjbGVcIik7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZm9yIChcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gYnVsbGV0TnVtYmVyO1xyXG4gICAgICAgICAgICBpbmRleCA8IHBob25lU2VsZWN0b3JBcmVhcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIGluZGV4KytcclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5lID0gcGhvbmVTZWxlY3RvckFyZWFzW2luZGV4XVxyXG4gICAgICAgICAgICAgIC5jaGlsZE5vZGVzWzVdIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgY29uc3QgYXJlYSA9IHBob25lU2VsZWN0b3JBcmVhc1tpbmRleCArIDFdO1xyXG5cclxuICAgICAgICAgICAgaWYgKGFyZWEpIHtcclxuICAgICAgICAgICAgICBjb25zdCBidWxsZXQgPSBhcmVhLmNoaWxkTm9kZXNbM10gYXMgSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4gICAgICAgICAgICAgIGxpbmUuY2xhc3NMaXN0LnJlbW92ZShcImxpbmUtc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgICAgbGluZS5jbGFzc0xpc3QuYWRkKFwibGluZVwiKTtcclxuXHJcbiAgICAgICAgICAgICAgYnVsbGV0LmNsYXNzTGlzdC5yZW1vdmUoXCJjaXJjbGUtc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgICAgYnVsbGV0LmNsYXNzTGlzdC5hZGQoXCJjaXJjbGVcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcGhvbmVTZWxlY3RvckFyZWFzLmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gcGhvbmVTZWxlY3RvckFyZWFzW2luZGV4XVxyXG4gICAgICAgICAgICAgIC5jaGlsZE5vZGVzWzddIGFzIEhUTUxQYXJhZ3JhcGhFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgaWYgKGluZGV4ID09PSBidWxsZXROdW1iZXIpIHtcclxuICAgICAgICAgICAgICB0ZXh0LmNsYXNzTGlzdC5hZGQoXCJsaW5lLXRleHQtc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGV4dC5jbGFzc0xpc3QucmVtb3ZlKFwibGluZS10ZXh0LXNlbGVjdGVkXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgUGxhbkNvbXBvbmVudC5jaGFuZ2VQbGFuRGF0YShidWxsZXROdW1iZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG59XHJcbiIsImltcG9ydCB7IEluaXRpYWxpemVyIH0gZnJvbSBcIi4uLy4uLy4uLy4uLy4uL3V0aWxpdGllcy9pbml0aWFsaXplclwiO1xyXG5pbXBvcnQgeyBzZWxlY3RvcnMgfSBmcm9tIFwiLi4vY29tbW9uL2Fzc2V0XCI7XHJcbmltcG9ydCB7IFRlc3RJbmZvIH0gZnJvbSBcIi4uL2NvbW1vbi90ZXN0LmluZm9cIjtcclxuaW1wb3J0IHsgTGluZUNvbXBvbmVudCB9IGZyb20gXCIuL2xpbmUuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IFBsYW5Db21wb25lbnQgfSBmcm9tIFwiLi9wbGFuLmNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBSZWRpcmVjdEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCIuL3JlZGlyZWN0LWJ1dHRvbi5jb21wb25lbnRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNYWluQ29tcG9uZW50IHtcclxuICBpbml0ID0gKCk6IHZvaWQgPT4ge1xyXG4gICAgSW5pdGlhbGl6ZXIuaW5pdChUZXN0SW5mbywgXCIwLjAuMVwiKTtcclxuXHJcbiAgICBjb25zdCBleGlzdFBsYW5TZWN0aW9uOiBudWxsIHwgRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHNlbGVjdG9ycy5leGlzdFBsYW5TZWN0aW9uXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChleGlzdFBsYW5TZWN0aW9uKSB7XHJcbiAgICAgIGNvbnN0IGxpbmVDb21wb25lbnQgPSBuZXcgTGluZUNvbXBvbmVudCgpO1xyXG4gICAgICBleGlzdFBsYW5TZWN0aW9uLmluc2VydEFkamFjZW50SFRNTChcImFmdGVyZW5kXCIsIGxpbmVDb21wb25lbnQucmVuZGVyKCkpO1xyXG5cclxuICAgICAgbGluZUNvbXBvbmVudC5hZGRCdWxsZXRDbGlja0V2ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcGxhbkNvbnRhaW5lcjogbnVsbCB8IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgc2VsZWN0b3JzLnBsYW5Db250YWluZXJcclxuICAgICk7XHJcblxyXG4gICAgaWYgKHBsYW5Db250YWluZXIpIHtcclxuICAgICAgcGxhbkNvbnRhaW5lci5pbnNlcnRBZGphY2VudEhUTUwoXHJcbiAgICAgICAgXCJhZnRlcmJlZ2luXCIsXHJcbiAgICAgICAgKHBsYW5Db250YWluZXIuZmlyc3RDaGlsZCBhcyBFbGVtZW50KS5vdXRlckhUTUxcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IHBsYW5JbnRlcm5ldFRleHRzOiBudWxsIHwgTm9kZUxpc3RPZjxIVE1MUGFyYWdyYXBoRWxlbWVudD4gPVxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJwLmNzcy0xM3F1OW5qXCIpO1xyXG5cclxuICAgICAgaWYgKHBsYW5JbnRlcm5ldFRleHRzICYmIHBsYW5JbnRlcm5ldFRleHRzLmxlbmd0aCA+IDMpIHtcclxuICAgICAgICBwbGFuSW50ZXJuZXRUZXh0c1sxXS50ZXh0Q29udGVudCA9IFwiMjVcIjtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFBsYW5Db21wb25lbnQuYWRkUExhbkNsaWNrRXZlbnQoKTtcclxuXHJcbiAgICBjb25zdCByZWRpcmVjdEJ1dHRvbkNvbXBvbmVudCA9IG5ldyBSZWRpcmVjdEJ1dHRvbkNvbXBvbmVudCgpO1xyXG4gICAgcmVkaXJlY3RCdXR0b25Db21wb25lbnQucmVuZGVyKCk7XHJcbiAgICByZWRpcmVjdEJ1dHRvbkNvbXBvbmVudC5hZGRSZWRpcmVjdEV2ZW50KCk7XHJcbiAgfTtcclxufVxyXG4iLCJpbXBvcnQgeyBtb2RhbFN0YXR1c0tleSwgc2VsZWN0b3JzIH0gZnJvbSBcIi4uL2NvbW1vbi9hc3NldFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1vZGFsQ29tcG9uZW50IHtcclxuICBnZXRIdG1sID0gKCk6IHN0cmluZyA9PiB7XHJcbiAgICBjb25zdCBodG1sU3RyaW5nOiBzdHJpbmcgPSBgXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhZGRlZC10by1jYXJ0LW1vZGFsXCIgc3R5bGU9XCJ6LWluZGV4OiAxOTAwMlwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNjaS1tb2RhbC1tYXNrXCIgc3R5bGU9XCJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2NpLW1vZGFsLXNjcm9sbC13cmFwcGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjY2ktbW9kYWwtd3JhcHBlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNjaS1tb2RhbC1jb250YWluZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBhcmlhLWxhYmVsPVwiQ2xvc2VcIiBjbGFzcz1cImNjaS1zaG9wcGluZy1tb2RhbC1jbG9zZSBidG4gYnRuLWxpbmtcIj48L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2NpLW1vZGFsLWhlYWRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDM+PC9oMz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2NpLW1vZGFsLWJvZHlcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gYXJpYS1sYWJlbD1cIkNoZWNrIG1hcmsgaW5kaWNhdGVzIHNlbGVjdGlvbiBoYXMgYmVlbiBtYWRlLlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImZhIGZhLWNoZWNrLWNpcmNsZSB3aGl0ZS1iZyBjaXJjbGUtaWNvbiBncmVlblwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtb2RhbC10aXRsZVwiPlN1Y2Nlc3NmdWxseSBBZGRlZCBUbyBDYXJ0PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicm93XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiL3Nob3BwaW5nL2Nob29zZS9kZXZpY2VcIiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBuZXh0LXN0ZXAtYnV0dG9uIGJ0bi1zaG9wXCI+IEFkZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEEgRGV2aWNlIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgYDtcclxuXHJcbiAgICByZXR1cm4gaHRtbFN0cmluZy50cmltKCk7XHJcbiAgfTtcclxuXHJcbiAgcmVuZGVyID0gKCkgPT4ge1xyXG4gICAgY29uc3QgcGxhY2VIb2xkZXJJbWFnZXM6IG51bGwgfCBOb2RlTGlzdE9mPEhUTUxJbWFnZUVsZW1lbnQ+ID1cclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMucGxhY2VIb2xkZXJJbWcpO1xyXG5cclxuICAgIGlmIChwbGFjZUhvbGRlckltYWdlcyAmJiBwbGFjZUhvbGRlckltYWdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpXHJcbiAgICAgICAgPy5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgdGhpcy5nZXRIdG1sKCkpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShtb2RhbFN0YXR1c0tleSk7XHJcblxyXG4gICAgICBjb25zdCBtb2RhbENsb3NlQnV0dG9uOiBudWxsIHwgSFRNTEJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgIHNlbGVjdG9ycy5tb2RhbENsb3NlQnV0dG9uXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBtb2RhbENsb3NlQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLm1vZGFsKT8ucmVtb3ZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIiwiaW1wb3J0IHsgcGxhbkluZm8sIHNlbGVjdG9ycyB9IGZyb20gXCIuLi9jb21tb24vYXNzZXRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQbGFuQ29tcG9uZW50IHtcclxuICBwdWJsaWMgc3RhdGljIGNoYW5nZVBsYW5EYXRhKGxpbmVOdW1iZXI6IG51bWJlcikge1xyXG4gICAgY29uc3QgcGxhbnMgPSBwbGFuSW5mb1tsaW5lTnVtYmVyXTtcclxuXHJcbiAgICBjb25zdCBwcmljZXM6IG51bGwgfCBOb2RlTGlzdE9mPEVsZW1lbnQ+ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgc2VsZWN0b3JzLnByaWNlXHJcbiAgICApO1xyXG5cclxuICAgIHByaWNlcy5mb3JFYWNoKChwcmljZSwgaW5kZXgpID0+IHtcclxuICAgICAgcHJpY2UudGV4dENvbnRlbnQgPSBwbGFuc1tpbmRleF0ucHJpY2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgYWRkUExhbkNsaWNrRXZlbnQoKSB7XHJcbiAgICBjb25zdCBwbGFuczogbnVsbCB8IE5vZGVMaXN0T2Y8RWxlbWVudD4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICBzZWxlY3RvcnMucGxhblxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAocGxhbnMgJiYgcGxhbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBwbGFuc1swXS5jbGFzc0xpc3QuYWRkKFwicGxhbi1zZWxlY3RlZFwiKTtcclxuXHJcbiAgICAgIHBsYW5zLmZvckVhY2goKHBsYW4pID0+IHtcclxuICAgICAgICBwbGFuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcGxhbnMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGlmIChwbGFuID09PSBwbGFuc1tpbmRleF0pIHtcclxuICAgICAgICAgICAgICBwbGFuc1tpbmRleF0uY2xhc3NMaXN0LmFkZChcInBsYW4tc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcGxhbnNbaW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoXCJwbGFuLXNlbGVjdGVkXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBzZWxlY3RvcnMgfSBmcm9tIFwiLi4vY29tbW9uL2Fzc2V0XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUmVkaXJlY3RCdXR0b25Db21wb25lbnQge1xyXG4gIGdldEh0bWwgPSAoKTogc3RyaW5nID0+IHtcclxuICAgIGNvbnN0IGh0bWxTdHJpbmc6IHN0cmluZyA9IGBcclxuICAgICAgPGJ1dHRvbiBocmVmPVwiaHR0cHM6Ly93d3cuY29uc3VtZXJjZWxsdWxhci5jb20vc2hvcHBpbmcvZGV0YWlscy9zaW1cIiBjbGFzcz1cInJlZGlyZWN0LWJ1dHRvblwiPlxyXG4gICAgICAgIEFkZCBUbyBDYXJ0XHJcbiAgICAgIDwvYnV0dG9uPlxyXG4gICAgYDtcclxuXHJcbiAgICByZXR1cm4gaHRtbFN0cmluZztcclxuICB9O1xyXG5cclxuICByZW5kZXIgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB2aWV3UGxhbkxpbms6IG51bGwgfCBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgc2VsZWN0b3JzLnZpZXdQbGFuTGlua1xyXG4gICAgKTtcclxuXHJcbiAgICBpZiAodmlld1BsYW5MaW5rKSB7XHJcbiAgICAgIHZpZXdQbGFuTGluay5pbnNlcnRBZGphY2VudEhUTUwoXCJhZnRlcmVuZFwiLCB0aGlzLmdldEh0bWwoKSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgYWRkUmVkaXJlY3RFdmVudCA9ICgpID0+IHtcclxuICAgIGNvbnN0IHJlZGlyZWN0QnV0dG9uOiBudWxsIHwgRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiYnV0dG9uLnJlZGlyZWN0LWJ1dHRvblwiXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChyZWRpcmVjdEJ1dHRvbikge1xyXG4gICAgICByZWRpcmVjdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkUGxhbk51bWJlciA9IHRoaXMuZ2V0U2VsZWN0ZWRQbGFuTnVtYmVyKCk7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRCdWxsZXROdW1iZXIgPSB0aGlzLmdldFNlbGVjdGVkQnVsbGV0TnVtYmVyKCk7XHJcbiAgICAgICAgdGhpcy5yZWRpcmVjdFRvUGxhblBhZ2Uoc2VsZWN0ZWRQbGFuTnVtYmVyLCBzZWxlY3RlZEJ1bGxldE51bWJlcik7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHJlZGlyZWN0VG9QbGFuUGFnZSA9IChwbGFuTnVtYmVyOiBudW1iZXIsIGJ1bGxldE51bWJlcjogbnVtYmVyKSA9PiB7XHJcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGBodHRwczovL3d3dy5jb25zdW1lcmNlbGx1bGFyLmNvbS9zaG9wcGluZy9jaG9vc2UvcGxhbj9saW5lPSR7YnVsbGV0TnVtYmVyfSZwbGFuPSR7cGxhbk51bWJlcn1gO1xyXG4gIH07XHJcblxyXG4gIGdldFNlbGVjdGVkUGxhbk51bWJlciA9ICgpOiBudW1iZXIgPT4ge1xyXG4gICAgbGV0IHNlbGVjdGVkUGxhbk51bWJlcjogbnVtYmVyID0gMDtcclxuXHJcbiAgICBjb25zdCBwbGFuczogbnVsbCB8IE5vZGVMaXN0T2Y8RWxlbWVudD4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICBzZWxlY3RvcnMucGxhblxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAocGxhbnMgJiYgcGxhbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBwbGFucy5mb3JFYWNoKChwbGFuLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIGlmIChwbGFuc1tpbmRleF0uY2xhc3NMaXN0LmNvbnRhaW5zKFwicGxhbi1zZWxlY3RlZFwiKSkge1xyXG4gICAgICAgICAgc2VsZWN0ZWRQbGFuTnVtYmVyID0gaW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc2VsZWN0ZWRQbGFuTnVtYmVyO1xyXG4gIH07XHJcblxyXG4gIGdldFNlbGVjdGVkQnVsbGV0TnVtYmVyID0gKCkgPT4ge1xyXG4gICAgbGV0IHNlbGVjdGVkQnVsbGV0TnVtYmVyOiBudW1iZXIgPSAwO1xyXG5cclxuICAgIGNvbnN0IGJ1bGxldHM6IG51bGwgfCBOb2RlTGlzdE9mPEVsZW1lbnQ+ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgc2VsZWN0b3JzLmJ1bGxldFxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoYnVsbGV0cyAmJiBidWxsZXRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgYnVsbGV0cy5mb3JFYWNoKChidWxsZXQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgaWYgKGJ1bGxldHNbaW5kZXhdLmNsYXNzTGlzdC5jb250YWlucyhcImNpcmNsZS1zZWxlY3RlZFwiKSkge1xyXG4gICAgICAgICAgc2VsZWN0ZWRCdWxsZXROdW1iZXIgPSBzZWxlY3RlZEJ1bGxldE51bWJlciArIGluZGV4O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHNlbGVjdGVkQnVsbGV0TnVtYmVyO1xyXG4gIH07XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFRlc3RPYnNlcnZlciB7XHJcbiAgcHJpdmF0ZSB0YXJnZXROb2RlOiBFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBjb25maWcgPSB7fTtcclxuXHJcbiAgY29uc3RydWN0b3IodGFyZ2V0Tm9kZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLnRhcmdldE5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldE5vZGUpO1xyXG4gICAgdGhpcy5jb25maWcgPSB7IGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9O1xyXG4gIH1cclxuXHJcbiAgb2JzZXJ2ZSA9IChjYWxsQmFjazogTXV0YXRpb25DYWxsYmFjaykgPT4ge1xyXG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihjYWxsQmFjayk7XHJcbiAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMudGFyZ2V0Tm9kZSBhcyBFbGVtZW50LCB0aGlzLmNvbmZpZyk7XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgY2xhc3MgSW5pdGlhbGl6ZXIge1xyXG4gIHN0YXRpYyBpbml0ID0gKFxyXG4gICAgdGVzdEluZm86IHtcclxuICAgICAgSUQ6IHN0cmluZztcclxuICAgICAgU0lURTogc3RyaW5nO1xyXG4gICAgICBDTElFTlQ6IHN0cmluZztcclxuICAgICAgVkFSSUFUSU9OOiBzdHJpbmc7XHJcbiAgICB9LFxyXG4gICAgdmVyc2lvbjogc3RyaW5nXHJcbiAgKTogdm9pZCA9PiB7XHJcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0ZXN0SW5mby5JRCk7XHJcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcclxuICAgICAgYCR7dGVzdEluZm8uSUR9LSR7dGVzdEluZm8uVkFSSUFUSU9OfWBcclxuICAgICk7XHJcbiAgICBjb25zb2xlLmluZm8oXHJcbiAgICAgIGBJRDogJHt0ZXN0SW5mby5JRH0sIFZBUklBVElPTjogJHt0ZXN0SW5mby5WQVJJQVRJT059LCBWRVJTSU9OOiAke3ZlcnNpb259IGlzIHJ1bm5pbmcuLi4uLiFgXHJcbiAgICApO1xyXG4gIH07XHJcbn1cclxuIiwiaW1wb3J0IHsgVXNlck9wdGlvbnMgfSBmcm9tIFwiLi91c2VyLm9wdGlvbnNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb2xsZXIge1xyXG4gIHByaXZhdGUgb3B0aW9uczogVXNlck9wdGlvbnMgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIHRpbWVvdXQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xyXG4gIHByaXZhdGUgc3VjY2Vzc2Z1bENvbmRpdGlvbnM6IGJvb2xlYW5bXSA9IFtdO1xyXG4gIHByaXZhdGUgY2FsbGJhY2s6IEZ1bmN0aW9uID0gKCkgPT4ge307XHJcbiAgcHJpdmF0ZSBjb25kaXRpb25zTGVuZ3RoOiBudW1iZXIgPSAwO1xyXG5cclxuICBwb2xsID0gKFxyXG4gICAgY29uZGl0aW9uczogKEZ1bmN0aW9uIHwgc3RyaW5nKVtdLFxyXG4gICAgY2FsbGJhY2s6IEZ1bmN0aW9uLFxyXG4gICAgdXNlck9wdGlvbnM/OiBVc2VyT3B0aW9uc1xyXG4gICkgPT4ge1xyXG4gICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xyXG4gICAgdGhpcy5vcHRpb25zID0gbmV3IFVzZXJPcHRpb25zKCk7XHJcbiAgICB0aGlzLmNvbmRpdGlvbnNMZW5ndGggPSBjb25kaXRpb25zLmxlbmd0aDtcclxuXHJcbiAgICBpZiAodXNlck9wdGlvbnMpIHtcclxuICAgICAgdGhpcy5vcHRpb25zID0gdXNlck9wdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy50aW1lb3V0ID0gdGhpcy5vcHRpb25zLnRpbWVvdXRcclxuICAgICAgPyBuZXcgRGF0ZSh0aGlzLmdldE5vdygpICsgdGhpcy5vcHRpb25zLnRpbWVvdXQpLmdldFRpbWUoKVxyXG4gICAgICA6IG51bGw7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25kaXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHRoaXMucG9sbEZvckNvbmRpdGlvbihcclxuICAgICAgICBjb25kaXRpb25zW2ldLFxyXG4gICAgICAgIHRoaXMub3B0aW9ucy53YWl0LFxyXG4gICAgICAgIHRydWUsXHJcbiAgICAgICAgdGhpcy5vcHRpb25zLm11bHRpcGxpZXJcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBnZXROb3cgPSAoKTogbnVtYmVyID0+IHtcclxuICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICB9O1xyXG5cclxuICBpc1RpbWVPdXQgPSAoKTogYm9vbGVhbiA9PiB7XHJcbiAgICBpZiAodGhpcy50aW1lb3V0ICYmIHRoaXMuZ2V0Tm93KCkgPiB0aGlzLnRpbWVvdXQpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfTtcclxuXHJcbiAgZXZhbHVhdGVDb25kaXRpb24gPSAoY29uZGl0aW9uOiBGdW5jdGlvbiB8IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xyXG4gICAgaWYgKCFjb25kaXRpb24pIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgcmV0dXJuIGNvbmRpdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSBcInN0cmluZ1wiICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZGl0aW9uKSkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfTtcclxuXHJcbiAgaXNBbGxDb25kaXRpb25QYXNzZWQgPSAoKTogYm9vbGVhbiA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5jb25kaXRpb25zTGVuZ3RoID09PSB0aGlzLnN1Y2Nlc3NmdWxDb25kaXRpb25zLmxlbmd0aDtcclxuICB9O1xyXG5cclxuICBwb2xsRm9yQ29uZGl0aW9uID0gKFxyXG4gICAgY29uZGl0aW9uOiBGdW5jdGlvbiB8IHN0cmluZyxcclxuICAgIHdhaXRUaW1lOiBudW1iZXIsXHJcbiAgICBza2lwV2FpdDogYm9vbGVhbixcclxuICAgIG11bHRpcGxpZXI6IG51bWJlclxyXG4gICk6IGJvb2xlYW4gPT4ge1xyXG4gICAgaWYgKHRoaXMudGltZW91dCAmJiB0aGlzLmlzVGltZU91dCgpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmV2YWx1YXRlQ29uZGl0aW9uKGNvbmRpdGlvbik7XHJcblxyXG4gICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICB0aGlzLnN1Y2Nlc3NmdWxDb25kaXRpb25zLnB1c2gocmVzdWx0KTtcclxuXHJcbiAgICAgIGlmICh0aGlzLmlzQWxsQ29uZGl0aW9uUGFzc2VkKCkpIHtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrKHRoaXMuc3VjY2Vzc2Z1bENvbmRpdGlvbnMpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZXRUaW1lb3V0KFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgIHRoaXMucG9sbEZvckNvbmRpdGlvbihcclxuICAgICAgICAgICAgY29uZGl0aW9uLFxyXG4gICAgICAgICAgICB3YWl0VGltZSAqIG11bHRpcGxpZXIsXHJcbiAgICAgICAgICAgIHNraXBXYWl0LFxyXG4gICAgICAgICAgICBtdWx0aXBsaWVyXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2tpcFdhaXQgPyAwIDogd2FpdFRpbWVcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBVc2VyT3B0aW9ucyB7XHJcbiAgd2FpdDogbnVtYmVyID0gNTA7XHJcbiAgbXVsdGlwbGllcjogbnVtYmVyID0gMS4xO1xyXG4gIHRpbWVvdXQ6IG51bWJlciA9IDA7XHJcbn1cclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImltcG9ydCB7IFBvbGxlciB9IGZyb20gXCIuLi8uLi8uLi8uLi91dGlsaXRpZXMvcG9sbGVyXCI7XHJcbmltcG9ydCB7IG1vZGFsU3RhdHVzS2V5LCBzZWxlY3RvcnMgfSBmcm9tIFwiLi9jb21tb24vYXNzZXRcIjtcclxuaW1wb3J0IHsgTGluZVNlbGVjdGlvbk1hbmFnZXIgfSBmcm9tIFwiLi9jb21wb25lbnRzL2xpbmUtc2VsZWN0aW9uLW1hbmFnZXJcIjtcclxuaW1wb3J0IHsgTWFpbkNvbXBvbmVudCB9IGZyb20gXCIuL2NvbXBvbmVudHMvbWFpbi5jb21wb25lbnRcIjtcclxuaW1wb3J0IHsgTW9kYWxDb21wb25lbnQgfSBmcm9tIFwiLi9jb21wb25lbnRzL21vZGFsLmNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBUZXN0T2JzZXJ2ZXIgfSBmcm9tIFwiLi9vYnNlcnZlci90ZXN0Lm9ic2VydmVyXCI7XHJcblxyXG5jb25zdCBpZUNoZWNrcyA9IC9NU0lFfFRyaWRlbnR8RWRnZVxcLygxMnwxM3wxNHwxNXwxNnwxN3wxOCkvLnRlc3QoXHJcbiAgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnRcclxuKTtcclxuXHJcbmlmICghaWVDaGVja3MpIHtcclxuICBjb25zdCBtYWluID0gbmV3IE1haW5Db21wb25lbnQoKTtcclxuICBjb25zdCBwb2xsZXIgPSBuZXcgUG9sbGVyKCk7XHJcbiAgcG9sbGVyLnBvbGwoXHJcbiAgICBbXCJib2R5XCIsIHNlbGVjdG9ycy5leGlzdFBsYW5TZWN0aW9uLCBzZWxlY3RvcnMucGxhbkNvbnRhaW5lcl0sXHJcbiAgICBtYWluLmluaXRcclxuICApO1xyXG5cclxuICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG5cclxuICBpZiAodXJsUGFyYW1zLmhhcyhcInBsYW5cIikgJiYgdXJsUGFyYW1zLmhhcyhcImxpbmVcIikpIHtcclxuICAgIGNvbnN0IHBsYW4gPSBOdW1iZXIodXJsUGFyYW1zLmdldChcInBsYW5cIikpO1xyXG4gICAgY29uc3QgbGluZSA9IE51bWJlcih1cmxQYXJhbXMuZ2V0KFwibGluZVwiKSk7XHJcblxyXG4gICAgY29uc3QgbGluZVNlbGVjdGlvbk1hbmFnZXIgPSBuZXcgTGluZVNlbGVjdGlvbk1hbmFnZXIocGxhbiwgbGluZSk7XHJcbiAgICBsaW5lU2VsZWN0aW9uTWFuYWdlci5zZWxlY3QoKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHRlc3RPYnNlcnZlciA9IG5ldyBUZXN0T2JzZXJ2ZXIoc2VsZWN0b3JzLnNob3BwaW5nUGFnZUNvbnRhaW5lcik7XHJcblxyXG4gIGNvbnN0IGNhbGxiYWNrID0gKG11dGF0aW9uTGlzdDogYW55LCBvYnNlcnZlcjogYW55KSA9PiB7XHJcbiAgICBjb25zdCBtb2RhbFN0YXR1cyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKG1vZGFsU3RhdHVzS2V5KTtcclxuICAgIGlmIChtb2RhbFN0YXR1cyA9PT0gXCJ0cnVlXCIgJiYgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSBcIi9zaG9wcGluZ1wiKSB7XHJcbiAgICAgIGNvbnN0IG1vZGFsQ29tcG9uZW50ID0gbmV3IE1vZGFsQ29tcG9uZW50KCk7XHJcbiAgICAgIG1vZGFsQ29tcG9uZW50LnJlbmRlcigpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHRlc3RPYnNlcnZlci5vYnNlcnZlKGNhbGxiYWNrKTtcclxufVxyXG4iXSwibmFtZXMiOlsic2VsZWN0b3JzIiwiZXhpc3RQbGFuU2VjdGlvbiIsImJ1bGxldCIsInBob25lU2VsZWN0b3JBcmVhIiwicGxhbkNvbnRhaW5lciIsInBsYW4iLCJwcmljZSIsInZpZXdQbGFuTGluayIsInBob25lU2VsZWN0b3IiLCJjaXJjbGUiLCJjb21ib1BsYW4iLCJidXR0b25TaG9wIiwibW9kYWxDbG9zZUJ1dHRvbiIsIm1vZGFsIiwic2hvcHBpbmdQYWdlQ29udGFpbmVyIiwicGxhY2VIb2xkZXJJbWciLCJtb2RhbFN0YXR1c0tleSIsInBsYW5JbmZvIiwiaW50ZXJuZXQiLCJUZXN0SW5mbyIsIkxpbmVTZWxlY3Rpb25NYW5hZ2VyIiwibGluZSIsInNlbGVjdCIsInNlbGVjdExpbmUiLCJzZWxlY3RQbGFuIiwiY2xpY2tBZGRUb0NhcnRCdXR0b24iLCJwaG9uZVNlbGVjdG9ycyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImxlbmd0aCIsImZvckVhY2giLCJwaG9uZSIsImluZGV4IiwicXVlcnlTZWxlY3RvciIsImNsaWNrIiwic2V0VGltZW91dCIsInBsYW5zIiwiYWRkVG9DYXJ0QnV0dG9uIiwiZ2V0QXR0cmlidXRlIiwiY2xvc2VNb2RhbCIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJ0aGlzIiwiSW5pdGlhbGl6ZXIiLCJpbml0IiwiTGluZUNvbXBvbmVudCIsInJlbmRlciIsInRyaW0iLCJhZGRCdWxsZXRDbGlja0V2ZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJidWxsZXRFbG0iLCJidWxsZXROdW1iZXIiLCJOdW1iZXIiLCJwaG9uZVNlbGVjdG9yQXJlYXMiLCJjaGlsZE5vZGVzIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiYXJlYSIsInRleHQiLCJQbGFuQ29tcG9uZW50IiwiY2hhbmdlUGxhbkRhdGEiLCJNYWluQ29tcG9uZW50IiwibGluZUNvbXBvbmVudCIsImluc2VydEFkamFjZW50SFRNTCIsImZpcnN0Q2hpbGQiLCJvdXRlckhUTUwiLCJwbGFuSW50ZXJuZXRUZXh0cyIsInRleHRDb250ZW50IiwiYWRkUExhbkNsaWNrRXZlbnQiLCJyZWRpcmVjdEJ1dHRvbkNvbXBvbmVudCIsIlJlZGlyZWN0QnV0dG9uQ29tcG9uZW50IiwiYWRkUmVkaXJlY3RFdmVudCIsIk1vZGFsQ29tcG9uZW50IiwiZ2V0SHRtbCIsInBsYWNlSG9sZGVySW1hZ2VzIiwicmVtb3ZlSXRlbSIsImxpbmVOdW1iZXIiLCJyZWRpcmVjdEJ1dHRvbiIsInNlbGVjdGVkUGxhbk51bWJlciIsImdldFNlbGVjdGVkUGxhbk51bWJlciIsInNlbGVjdGVkQnVsbGV0TnVtYmVyIiwiZ2V0U2VsZWN0ZWRCdWxsZXROdW1iZXIiLCJyZWRpcmVjdFRvUGxhblBhZ2UiLCJwbGFuTnVtYmVyIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiY29udGFpbnMiLCJidWxsZXRzIiwiVGVzdE9ic2VydmVyIiwidGFyZ2V0Tm9kZSIsImNvbmZpZyIsIm9ic2VydmUiLCJjYWxsQmFjayIsIk11dGF0aW9uT2JzZXJ2ZXIiLCJhdHRyaWJ1dGVzIiwiY2hpbGRMaXN0Iiwic3VidHJlZSIsInRlc3RJbmZvIiwidmVyc2lvbiIsImRvY3VtZW50RWxlbWVudCIsIklEIiwiVkFSSUFUSU9OIiwiY29uc29sZSIsImluZm8iLCJQb2xsZXIiLCJvcHRpb25zIiwidGltZW91dCIsInN1Y2Nlc3NmdWxDb25kaXRpb25zIiwiY2FsbGJhY2siLCJjb25kaXRpb25zTGVuZ3RoIiwicG9sbCIsImNvbmRpdGlvbnMiLCJ1c2VyT3B0aW9ucyIsIlVzZXJPcHRpb25zIiwiRGF0ZSIsImdldE5vdyIsImdldFRpbWUiLCJpIiwicG9sbEZvckNvbmRpdGlvbiIsIndhaXQiLCJtdWx0aXBsaWVyIiwiaXNUaW1lT3V0IiwiZXZhbHVhdGVDb25kaXRpb24iLCJjb25kaXRpb24iLCJpc0FsbENvbmRpdGlvblBhc3NlZCIsIndhaXRUaW1lIiwic2tpcFdhaXQiLCJyZXN1bHQiLCJwdXNoIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJ0ZXN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibWFpbiIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInNlYXJjaCIsImhhcyIsImdldCIsIm11dGF0aW9uTGlzdCIsIm9ic2VydmVyIiwiZ2V0SXRlbSIsInBhdGhuYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==